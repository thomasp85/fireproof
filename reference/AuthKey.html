<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>R6 class for the Key authentication scheme — AuthKey • fireproof</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="R6 class for the Key authentication scheme — AuthKey"><meta property="og:description" content="This class encapsulates the logic of the key based authentication scheme. See
auth_key() for more information"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fireproof</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/thomasp85/fireproof/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>R6 class for the Key authentication scheme</h1>
    <small class="dont-index">Source: <a href="https://github.com/thomasp85/fireproof/blob/main/R/auth_key.R" class="external-link"><code>R/auth_key.R</code></a></small>
    <div class="hidden name"><code>AuthKey.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This class encapsulates the logic of the key based authentication scheme. See
<code><a href="auth_key.html">auth_key()</a></code> for more information</p>
    </div>


    <div id="super-class">
    <h2>Super class</h2>
    <p><code><a href="Auth.html">fireproof::Auth</a></code> -&gt; <code>AuthKey</code></p>
    </div>
    <div id="active-bindings">
    <h2>Active bindings</h2>
    <p></p><div class="r6-active-bindings"><dl><dt><code>location</code></dt>
<dd><p>The location of the secret in the request, either
<code>"cookie"</code> or <code>"header"</code></p></dd>


<dt><code>open_api</code></dt>
<dd><p>An OpenID compliant security scheme description</p></dd>


</dl><p></p></div>
    </div>
    <div id="methods">
    <h2>Methods</h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-AuthKey-new"><code>AuthKey$new()</code></a></p></li>
<li><p><a href="#method-AuthKey-check_request"><code>AuthKey$check_request()</code></a></p></li>
<li><p><a href="#method-AuthKey-reject_response"><code>AuthKey$reject_response()</code></a></p></li>
<li><p><a href="#method-AuthKey-clone"><code>AuthKey$clone()</code></a></p></li>
</ul></div><p><details open><summary>Inherited methods</summary><ul><li><span class="pkg-link" data-pkg="fireproof" data-topic="Auth" data-id="forbid_user"><a href="Auth.html#method-forbid_user"><code>fireproof::Auth$forbid_user()</code></a></span></li>
<li><span class="pkg-link" data-pkg="fireproof" data-topic="Auth" data-id="register_handler"><a href="Auth.html#method-register_handler"><code>fireproof::Auth$register_handler()</code></a></span></li>
</ul></details></p><hr><a id="method-AuthKey-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Constructor for the class</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/AuthKey.html">AuthKey</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">key</span>, <span class="va">secret</span>, user_info <span class="op">=</span> <span class="cn">NULL</span>, cookie <span class="op">=</span> <span class="cn">TRUE</span>, name <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>key</code></dt>
<dd><p>The name of the header or cookie to store the secret under</p></dd>


<dt><code>secret</code></dt>
<dd><p>The secret to check for. Either a single string with the secret
or a function that will be called with the arguments <code>key</code>, <code>request</code>, and
<code>response</code> and returns <code>TRUE</code> if its a valid secret (useful if you have
multiple or rotating secrets). If the function returns a character vector it
is considered to be authenticated and the return value will be understood as
scopes the user is granted. Make sure never to store secrets in plain text
and avoid checking them into version control.</p></dd>


<dt><code>user_info</code></dt>
<dd><p>A function to extract user information from the
username. It is called with two arguments: <code>token</code> and <code>setter</code>,
the first being the key used for the successful authentication, the
second being a function that must be called in the end with the relevant
information (see <code><a href="user_info.html">user_info()</a></code>).</p></dd>


<dt><code>cookie</code></dt>
<dd><p>Boolean. Should the secret be transmitted as a cookie. If
<code>FALSE</code> it is expected to be transmitted as a header.</p></dd>


<dt><code>name</code></dt>
<dd><p>The name of the scheme instance</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-AuthKey-check_request"></a><div class="section">
<h3 id="method-check-request-">Method <code>check_request()</code><a class="anchor" aria-label="anchor" href="#method-check-request-"></a></h3>
<p>A function that validates an incoming request, returning
<code>TRUE</code> if it is valid and <code>FALSE</code> if not. It extracts the secret from
either the cookie or header based on the provided <code>key</code> and test it
against the provided <code>secret</code>.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">AuthKey</span><span class="op">$</span><span class="fu">check_request</span><span class="op">(</span><span class="va">request</span>, <span class="va">response</span>, <span class="va">keys</span>, <span class="va">...</span>, <span class="va">.session</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>request</code></dt>
<dd><p>The request to validate as a <a href="https://reqres.data-imaginist.com/reference/Request.html" class="external-link">Request</a>
object</p></dd>


<dt><code>response</code></dt>
<dd><p>The corresponding response to the request as a
<a href="https://reqres.data-imaginist.com/reference/Response.html" class="external-link">Response</a> object</p></dd>


<dt><code>keys</code></dt>
<dd><p>A named list of path parameters from the path matching</p></dd>


<dt><code>...</code></dt>
<dd><p>Ignored</p></dd>


<dt><code>.session</code></dt>
<dd><p>The session storage for the current session</p></dd>


<dt><code>server</code></dt>
<dd><p>The fiery server handling the request</p></dd>


<dt><code>arg_list</code></dt>
<dd><p>A list of additional arguments extracted be the
<code>before_request</code> handlers (will be used to access the session data store)</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-AuthKey-reject_response"></a><div class="section">
<h3 id="method-reject-response-">Method <code>reject_response()</code><a class="anchor" aria-label="anchor" href="#method-reject-response-"></a></h3>
<p>Upon rejection this scheme sets the response status to <code>400</code>
if it has not already been set by others. In contrast to the other
schemes that are proper HTTP schemes, this one doesn't set a
<code>WWW-Authenticate</code> header.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">AuthKey</span><span class="op">$</span><span class="fu">reject_response</span><span class="op">(</span><span class="va">response</span>, <span class="va">scope</span>, <span class="va">...</span>, <span class="va">.session</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>response</code></dt>
<dd><p>The response object</p></dd>


<dt><code>scope</code></dt>
<dd><p>The scope of the endpoint</p></dd>


<dt><code>...</code></dt>
<dd><p>Ignored</p></dd>


<dt><code>.session</code></dt>
<dd><p>The session storage for the current session</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-AuthKey-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">AuthKey</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create an authenticator of dubious quality</span></span></span>
<span class="r-in"><span><span class="va">key</span> <span class="op">&lt;-</span> <span class="fu"><a href="auth_key.html">auth_key</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  key <span class="op">=</span> <span class="st">"my-key-location"</span>,</span></span>
<span class="r-in"><span>  secret <span class="op">=</span> <span class="st">"SHHH!!DONT_TELL_ANYONE"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Thomas Lin Pedersen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

