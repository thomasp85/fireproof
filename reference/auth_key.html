<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Authentication based on shared secret — auth_key • fireproof</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Authentication based on shared secret — auth_key"><meta property="og:description" content="This authentication scheme is based on a mutually shared secret between the
server and the client. The client provides this secret either as a header or
in a cookie, and the server verifies the authenticity of the secret. Like
with basic authentication, this scheme relies on additional
technology like HTTPS/SSL to make it secure since the secret can otherwise
easily be extracted from the request by man-in-the-middle attack."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fireproof</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/thomasp85/fireproof/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Authentication based on shared secret</h1>
    <small class="dont-index">Source: <a href="https://github.com/thomasp85/fireproof/blob/main/R/auth_key.R" class="external-link"><code>R/auth_key.R</code></a></small>
    <div class="hidden name"><code>auth_key.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This authentication scheme is based on a mutually shared secret between the
server and the client. The client provides this secret either as a header or
in a cookie, and the server verifies the authenticity of the secret. Like
with <a href="auth_basic.html">basic authentication</a>, this scheme relies on additional
technology like HTTPS/SSL to make it secure since the secret can otherwise
easily be extracted from the request by man-in-the-middle attack.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">auth_key</span><span class="op">(</span><span class="va">key</span>, <span class="va">secret</span>, user_info <span class="op">=</span> <span class="cn">NULL</span>, cookie <span class="op">=</span> <span class="cn">TRUE</span>, name <span class="op">=</span> <span class="st">"KeyAuth"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-key">key<a class="anchor" aria-label="anchor" href="#arg-key"></a></dt>
<dd><p>The name of the header or cookie to store the secret under</p></dd>


<dt id="arg-secret">secret<a class="anchor" aria-label="anchor" href="#arg-secret"></a></dt>
<dd><p>The secret to check for. Either a single string with the secret
or a function that will be called with the arguments <code>key</code>, <code>request</code>, and
<code>response</code> and returns <code>TRUE</code> if its a valid secret (useful if you have
multiple or rotating secrets). If the function returns a character vector it
is considered to be authenticated and the return value will be understood as
scopes the user is granted. Make sure never to store secrets in plain text
and avoid checking them into version control.</p></dd>


<dt id="arg-user-info">user_info<a class="anchor" aria-label="anchor" href="#arg-user-info"></a></dt>
<dd><p>A function to extract user information from the
username. It is called with two arguments: <code>key</code> and <code>setter</code>,
the first being the key used for the successful authentication, the
second being a function that must be called in the end with the relevant
information (see <code><a href="user_info.html">user_info()</a></code>).</p></dd>


<dt id="arg-cookie">cookie<a class="anchor" aria-label="anchor" href="#arg-cookie"></a></dt>
<dd><p>Boolean. Should the secret be transmitted as a cookie. If
<code>FALSE</code> it is expected to be transmitted as a header.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>The name of the authentication</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <a href="AuthKey.html">AuthKey</a> object</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This authentication is not a classic HTTP authentication scheme and thus
doesn't return a <code>401</code> response with a <code>WWW-Authenticate</code> header. Instead it
returns a <code>400</code> response unless another authenticator has already set the
response status to something else.</p>
    </div>
    <div id="user-information">
    <h2>User information</h2>
    <p><code>auth_key()</code> automatically adds <a href="user_info.html">user information</a> after
authentication. By default it will set the <code>provider</code> field to <code>"local"</code>.
Further, it will set the <code>scopes</code> field to any scopes returned by the
<code>authenticator</code> function.</p>
<p>Since Key based authentication is seldom used with user specific keys it is
unlikely that it makes sense to populate the information any further.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create an authenticator of dubious quality</span></span></span>
<span class="r-in"><span><span class="va">key</span> <span class="op">&lt;-</span> <span class="fu">auth_key</span><span class="op">(</span></span></span>
<span class="r-in"><span>  key <span class="op">=</span> <span class="st">"my-key-location"</span>,</span></span>
<span class="r-in"><span>  secret <span class="op">=</span> <span class="st">"SHHH!!DONT_TELL_ANYONE"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add it to a fireproof plugin</span></span></span>
<span class="r-in"><span><span class="va">fp</span> <span class="op">&lt;-</span> <span class="va"><a href="Fireproof.html">Fireproof</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fp</span><span class="op">$</span><span class="fu">add_auth</span><span class="op">(</span><span class="va">key</span>, <span class="st">"key_auth"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use it in an endpoint</span></span></span>
<span class="r-in"><span><span class="va">fp</span><span class="op">$</span><span class="fu">add_auth_handler</span><span class="op">(</span><span class="st">"get"</span>, <span class="st">"/*"</span>, <span class="va">key_auth</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Thomas Lin Pedersen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

